# ะะฝัะตะณัะฐัะธั Bookechi ะฒ Telegram-ะฑะพั

## ะัะฟะพะปะฝะตะฝะฝัะต ะทะฐะดะฐะฝะธั

### 1. RAG ะดะปั ะดะพะบัะผะตะฝัะฐัะธะธ ะฟัะพะตะบัะฐ โ

ะะฐะทะฐ ะทะฝะฐะฝะธะน ัะตะฟะตัั ัะพะดะตัะถะธั:
- ะะพะบัะผะตะฝัะฐัะธั ะฟัะพะตะบัะฐ Bookechi (`kb/bookechi_docs.md`)
- ะััะพะดะฝัะน ะบะพะด ะฒัะตั Kotlin ัะฐะนะปะพะฒ ะธะท ัะตะฟะพะทะธัะพัะธั
- ะะฝะดะตะบั: `doc_index/bookechi.sqlite` (394 ัะฐะฝะบะฐ)

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```
/kb_status        โ ััะฐััั ะฑะฐะทั ะทะฝะฐะฝะธะน
/kb_ask <ะฒะพะฟัะพั>  โ ะทะฐะดะฐัั ะฒะพะฟัะพั ะฟะพ ะดะพะบัะผะตะฝัะฐัะธะธ
/kb_reindex       โ ะฟะตัะตัะพะฑัะฐัั ะธะฝะดะตะบั
```

### 2. MCP ะดะปั Git-ัะตะฟะพะทะธัะพัะธั โ

ะกะพะทะดะฐะฝ MCP ัะตัะฒะตั (`mcp-git-server/git_mcp_server.py`) ั ะธะฝััััะผะตะฝัะฐะผะธ:
- `git_branch` โ ัะตะบััะฐั ะฒะตัะบะฐ
- `git_status` โ ะธะทะผะตะฝัะฝะฝัะต ัะฐะนะปั
- `git_log` โ ะธััะพัะธั ะบะพะผะผะธัะพะฒ
- `git_diff` โ ะฟัะพัะผะพัั ะธะทะผะตะฝะตะฝะธะน
- `read_file` โ ััะตะฝะธะต ัะฐะนะปะพะฒ
- `list_files` โ ัะฟะธัะพะบ ัะฐะนะปะพะฒ
- `search_code` โ ะฟะพะธัะบ ะฟะพ ะบะพะดั
- `file_history` โ ะธััะพัะธั ัะฐะนะปะฐ

**Telegram ะบะพะผะฐะฝะดั:**
```
/git_status       โ ััะฐััั ัะตะฟะพะทะธัะพัะธั
/git_branch       โ ัะตะบััะฐั ะฒะตัะบะฐ
/git_log [N]      โ ะฟะพัะปะตะดะฝะธะต N ะบะพะผะผะธัะพะฒ
/git_files [ะฟััั] โ ัะฐะนะปั ะฒ ะดะธัะตะบัะพัะธะธ
/git_show <ัะฐะนะป>  โ ะฟะพะบะฐะทะฐัั ัะพะดะตัะถะธะผะพะต ัะฐะนะปะฐ
```

### 3. ะะพะผะฐะฝะดะฐ /help โ

ะฃะผะฝัะน ะฟะพะผะพัะฝะธะบ ะฟะพ ะฟัะพะตะบัั, ะธัะฟะพะปัะทัััะธะน RAG + Git:

```
/help                    โ ะฟะพะบะฐะทะฐัั ะผะตะฝั ะธ ััะฐััั
/help <ะฒะพะฟัะพั>           โ ะพัะฒะตัะธัั ะฝะฐ ะฒะพะฟัะพั ะพ ะฟัะพะตะบัะต
```

**ะัะธะผะตัั ะฒะพะฟัะพัะพะฒ:**
- `/help ะบะฐะบ ะดะพะฑะฐะฒะธัั ะฝะพะฒัั ะบะฝะธะณั?`
- `/help ะบะฐะบะฐั ะฐััะธัะตะบัััะฐ ะธัะฟะพะปัะทัะตััั?`
- `/help ะฟะพะบะฐะถะธ ะฟัะธะผะตั ViewModel`
- `/help ะบะฐะบะธะต ะทะฐะฒะธัะธะผะพััะธ ะฒ ะฟัะพะตะบัะต?`
- `/help ะบะฐะบ ัะฐะฑะพัะฐะตั Room ะฒ ะฟัะพะตะบัะต?`
- `/help ะฟะพะบะฐะถะธ ััััะบัััั ะผะพะดะตะปะธ Book`

## ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
server/
โโโ bookechi_repo/              # ะกะบะปะพะฝะธัะพะฒะฐะฝะฝัะน ัะตะฟะพะทะธัะพัะธะน Bookechi
โ   โโโ app/src/main/java/...   # ะััะพะดะฝัะน ะบะพะด ะฟัะธะปะพะถะตะฝะธั
โโโ kb/
โ   โโโ bookechi_docs.md        # ะะพะบัะผะตะฝัะฐัะธั ะฟัะพะตะบัะฐ (ะดะปั RAG)
โ   โโโ knowledge_base.txt      # ะกัะฐัะฐั KB (ะฝะต ะธัะฟะพะปัะทัะตััั)
โโโ doc_index/
โ   โโโ bookechi.sqlite         # RAG ะธะฝะดะตะบั Bookechi (394 ัะฐะฝะบะฐ)
โ   โโโ knowledge_base.sqlite   # ะกัะฐััะน ะธะฝะดะตะบั
โโโ mcp-git-server/
โ   โโโ git_mcp_server.py       # MCP ัะตัะฒะตั ะดะปั Git
โ   โโโ README.md               # ะะพะบัะผะตะฝัะฐัะธั MCP ัะตัะฒะตัะฐ
โโโ telegram_chat_bot/
    โโโ simple_bot.py           # Telegram ะฑะพั ั ะธะฝัะตะณัะฐัะธะตะน
```

## ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

```bash
# ะััั ะบ ัะตะฟะพะทะธัะพัะธั Bookechi (ะฟะพ ัะผะพะปัะฐะฝะธั: bookechi_repo)
BOOKECHI_REPO_PATH=/path/to/bookechi_repo

# ะััั ะบ ะฑะฐะทะต ะทะฝะฐะฝะธะน (ะฟะพ ัะผะพะปัะฐะฝะธั: kb/bookechi_docs.md)
KB_SOURCE_PATH=/path/to/kb/bookechi_docs.md

# ะััั ะบ ะธะฝะดะตะบัั (ะฟะพ ัะผะพะปัะฐะฝะธั: doc_index/bookechi.sqlite)
KB_INDEX_PATH=/path/to/doc_index/bookechi.sqlite
```

## ะะฐะฟััะบ

### 1. ะะฐะฟััะบ Telegram ะฑะพัะฐ
```bash
cd server/telegram_chat_bot
python3 simple_bot.py
```

### 2. ะะฐะฟััะบ MCP ัะตัะฒะตัะฐ (ะพัะดะตะปัะฝะพ, ะตัะปะธ ะฝัะถะฝะพ)
```bash
cd server/mcp-git-server
python3 git_mcp_server.py
```

### 3. ะะฑะฝะพะฒะปะตะฝะธะต ะธะฝะดะตะบัะฐ (ะตัะปะธ ะบะพะด ะธะทะผะตะฝะธะปัั)
```bash
cd server
python3 tools/build_doc_index.py \
  --input kb/bookechi_docs.md \
  --input-dir bookechi_repo/app/src/main/java \
  --ext kt \
  --store sqlite \
  --out doc_index/bookechi.sqlite
```

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### RAG ะทะฐะฟัะพัั
```
ะะพะปัะทะพะฒะฐัะตะปั: /help ะบะฐะบะธะต ะผะพะดะตะปะธ ะดะฐะฝะฝัั ะตััั ะฒ ะฟัะพะตะบัะต?
ะะพั: ะ ะฟัะพะตะบัะต Bookechi ะธัะฟะพะปัะทััััั ัะปะตะดัััะธะต ะผะพะดะตะปะธ ะดะฐะฝะฝัั:

1. **Book** โ ะพัะฝะพะฒะฝะฐั ะผะพะดะตะปั ะบะฝะธะณะธ ั ะฟะพะปัะผะธ:
   - id, name, author, coverPath, pages, currentPage, readingStatus

2. **ReadingSession** โ ัะตััะธั ััะตะฝะธั ั ะฟะพะปัะผะธ:
   - id, bookId, date, pagesRead, readingTimeMinutes, startPage, endPage

3. **ReadingStatus** โ enum ััะฐัััะพะฒ:
   - None, Reading, Paused, Stopped

4. **ActivityIntensity** โ ะธะฝัะตะฝัะธะฒะฝะพััั ััะตะฝะธั ะดะปั ัะฐััะพะฒ
...
```

### Git ะบะพะผะฐะฝะดั
```
ะะพะปัะทะพะฒะฐัะตะปั: /git_status
ะะพั:
๐ฟ ะะตัะบะฐ: main
โ ะะฐะฑะพัะฐั ะดะธัะตะบัะพัะธั ัะธััะฐั

ะะพะปัะทะพะฒะฐัะตะปั: /git_show app/src/main/java/fuwafuwa/time/bookechi/data/model/Book.kt
ะะพั:
๐ app/src/main/java/fuwafuwa/time/bookechi/data/model/Book.kt

```kotlin
@Entity
data class Book(
    @PrimaryKey(autoGenerate = true) val id: Long = 0,
    val name: String,
    val author: String,
    ...
)
```
```

## ะััะธัะตะบัััะฐ ัะตัะตะฝะธั

```
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโ
โ  Telegram User  โโโโโโถโ  Telegram Bot    โ
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโฌโโโโโโโโโโ
                                 โ
         โโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
โ   RAG (KB)      โ     โ   Git Commands  โ     โ   MCP Server    โ
โ                 โ     โ                 โ     โ   (stdio)       โ
โ bookechi.sqlite โ     โ subprocess git  โ     โ git_mcp_server  โ
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโ
                                 โ
                                 โผ
                      โโโโโโโโโโโโโโโโโโโโโโโ
                      โ   Bookechi Repo     โ
                      โ   (bookechi_repo/)  โ
                      โโโโโโโโโโโโโโโโโโโโโโโ
```

## ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### RAG Pipeline
1. ะะพะบัะผะตะฝัะฐัะธั ัะฐะทะฑะธะฒะฐะตััั ะฝะฐ ัะฐะฝะบะธ (1200 ัะธะผะฒะพะปะพะฒ ั ะฟะตัะตะบัััะธะตะผ 150)
2. ะะฐะถะดัะน ัะฐะฝะบ ะฟัะตะพะฑัะฐะทัะตััั ะฒ ัะผะฑะตะดะดะธะฝะณ (paraphrase-multilingual-MiniLM-L12-v2)
3. ะัะธ ะทะฐะฟัะพัะต: ะฒะพะฟัะพั โ ัะผะฑะตะดะดะธะฝะณ โ cosine similarity โ top-k ัะฐะฝะบะพะฒ
4. ะะพะฝัะตะบัั ะฟะตัะตะดะฐัััั ะฒ LLM ะดะปั ะณะตะฝะตัะฐัะธะธ ะพัะฒะตัะฐ

### Git ะธะฝัะตะณัะฐัะธั
1. ะััะผัะต ะฒัะทะพะฒั git ัะตัะตะท subprocess
2. MCP ัะตัะฒะตั ะดะปั ััะฐะฝะดะฐััะธะทะธัะพะฒะฐะฝะฝะพะณะพ API
3. ะะพะผะฐะฝะดั ะฑะพัะฐ ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ ะบ ััะฐัััั

